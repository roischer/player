var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,a,c){b!=Array.prototype&&b!=Object.prototype&&(b[a]=c.value)};$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(b,a,c,g){if(a){c=$jscomp.global;b=b.split(".");for(g=0;g<b.length-1;g++){var d=b[g];d in c||(c[d]={});c=c[d]}b=b[b.length-1];g=c[b];a=a(g);a!=g&&null!=a&&$jscomp.defineProperty(c,b,{configurable:!0,writable:!0,value:a})}};$jscomp.polyfill("Array.prototype.fill",function(b){return b?b:function(a,c,b){var d=this.length||0;0>c&&(c=Math.max(0,d+c));if(null==b||b>d)b=d;b=Number(b);0>b&&(b=Math.max(0,d+b));for(c=Number(c||0);c<b;c++)this[c]=a;return this}},"es6","es3");
var admanager,core,bind=function(b,a){return function(){return b.apply(a,arguments)}},extend=function(b,a){function c(){this.constructor=b}for(var g in a)hasProp.call(a,g)&&(b[g]=a[g]);c.prototype=a.prototype;b.prototype=new c;b.__super__=a.prototype;return b},hasProp={}.hasOwnProperty;admanager=this.admanager||{};admanager.controller=this.admanager.controller||{};admanager.event=this.admanager.event||{};admanager.model=this.admanager.model||{};admanager.view=this.admanager.view||{};
core=this.core||{};core.common=this.core.common||{};core.event=this.core.event||{};core.model=this.core.model||{};admanager.event.Event=function(){function b(){}b.PLUGIN_READY="pluginReady";b.PLUGIN_ERROR="pluginError";b.DATA_LOAD_COMPLETE="dataLoadComplete";b.AD_COMPLETE="adComplete";b.AD_REPORTED="adReported";b.AD_STARTED="adStarted";b.AD_STOPPED="adStopped";return b}();
admanager.controller.Controller=function(){function b(c){this.manager=c;this._onAdDataLoadComplete=bind(this._onAdDataLoadComplete,this);this.manager.models.on(a.DATA_LOAD_COMPLETE,this._onAdDataLoadComplete)}var a=admanager.event.Event;b.prototype._onAdDataLoadComplete=function(){var c=this.manager.models.getData();0<c.length&&this.manager.views.populate(c);return this.manager.emit(a.PLUGIN_READY)};return b}();
core.common.Utils=function(){function b(){}b.setCookie=function(a,c){return document.cookie=a+"="+c};b.getCookie=function(a){if(-1!==document.cookie.indexOf(a+"=")){var c=void 0;0<document.cookie.length&&(c=document.cookie.indexOf(a+"="));if(-1!==c)return c=c+a.length+1,a=document.cookie.indexOf(";",c),-1===a&&(a=document.cookie.length),c=unescape(document.cookie.substring(c,a)),"true"===c&&(c=!0),"false"===c&&(c=!1),"undefined"===c&&(c=void 0),"undefined"===c&&(c=null),c}};b.clearCookie=function(a){return document.cookie=
a+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT"};b.clearCookies=function(){var a;var c=document.cookie.split(";");var b=[];var d=0;for(a=c.length;d<a;d++){var f=c[d];var e=f.indexOf("=");f=-1<e?f.substr(0,e):f;b.push(document.cookie=f+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT")}return b};b.getQuery=function(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");a=(new RegExp("[\\?&]"+a+"=([^&#]*)")).exec(location.search);return null==a?void 0:decodeURIComponent(a[1].replace(/\+/g," "))};b.searchify=function(a){var c=
[];for(b in a){var b=encodeURIComponent(b);var d=encodeURIComponent(a[b]);c.push(b+"="+d)}return c.join("&")};b.on=function(a,c,b){if(a.addEventListener)return a.addEventListener(c,b,!1);if(a.attachEvent)return a["e"+c+b]=b,a[c+b]=function(){return a["e"+c+b](window.event)}};b.off=function(a,c,b){if(a.removeEventListener)return a.removeEventListener(c,b,!1);if(a.detachEvent)return a.detachEvent("on"+c,a[c+b]),a[c+b]=null,a["e"+c+b]=null};b.domLoaded=function(){return"complete"===document.readyState||
"interactive"===document.readyState};b.request=function(a,c){var b=new XMLHttpRequest;b.open("GET",a,!0);b.onreadystatechange=function(){if(4===b.readyState)return 200!==b.status&&304!==b.status?"function"===typeof c?c({error:!0}):void 0:"function"===typeof c?c({data:b.responseText}):void 0};return b.send()};b["typeof"]=function(a){if(null==a)return!1;a=a.constructor.toString();a=a.split("()")[0];a=a.replace("function ","");a=a.trim();return 0<a.length?a:!1};b.loadScript=function(a,c){var b=document.createElement("script");
b.src=a;b.onload=c;document.getElementsByTagName("head")[0].appendChild(b);return b};b.getPosition=function(a){var c,b;for(b=c=0;a;)c+=a.offsetLeft-a.scrollLeft+a.clientLeft,b+=a.offsetTop-a.scrollTop+a.clientTop,a=a.offsetParent;return{x:c,y:b}};b.isMobile=function(){return!!navigator.userAgent.match(/(Android)|(iPhone)|(webOS)|(iPad)|(iPod)|(BlackBerry)|(Windows Phone)/i)};b.getScreenSize=function(){var a=1<window.devicePixelRatio?window.devicePixelRatio:1;return{width:screen.width/a({height:screen.height/
a})}};return b}();
admanager.model.AdModel=function(){function b(c){this._config=c;this._getRetVal=bind(this._getRetVal,this);this._getSkipOffset=bind(this._getSkipOffset,this);this._getCreativeNode=bind(this._getCreativeNode,this);this._getImpressions=bind(this._getImpressions,this);this._getType=bind(this._getType,this);this._getCompanion=bind(this._getCompanion,this);this._getClickUrl=bind(this._getClickUrl,this);this._getTracking=bind(this._getTracking,this);this._getVpaidCreative=bind(this._getVpaidCreative,this);
this._getVastCreatives=bind(this._getVastCreatives,this);this._getCreatives=bind(this._getCreatives,this);this._getFormat=bind(this._getFormat,this);this._getOffset=bind(this._getOffset,this);this._getNode=bind(this._getNode,this);if("String"===a["typeof"](this._config.data)&&(this._node=this._getNode(),this.data=this._config.data,this.url=this._config.url,this.format=this._getFormat(),this.type=this._getType(),this.creatives=this._getCreatives()))return this.companion=this._getCompanion(),this.impressions=
this._getImpressions(),this.offset=this._getOffset(),this.skipOffset=this._getSkipOffset(),this._getRetVal()}var a=core.common.Utils;b.prototype._getNode=function(){return(new DOMParser).parseFromString(this._config.data,"text/xml")};b.prototype._getOffset=function(){var a=this._config.offset;if("end"===a)return a;a=Number(a);if(isNaN(a)||0>a)a=0;return a};b.prototype._getFormat=function(){var a;(a=this._node.getElementsByTagName("Linear")[0])||(a=this._node.getElementsByTagName("NonLinear")[0]);
if(a)return"Linear"===a.nodeName?"Linear":"NonLinear"};b.prototype._getCreatives=function(){if("VAST"===this.type)return this._getVastCreatives();if("VPAID"===this.type)return this._getVpaidCreative()};b.prototype._getVastCreatives=function(){var a;var b=[];var d=this._node.getElementsByTagName("Creative");var f=0;for(a=d.length;f<a;f++){var e=d[f];if(e.getElementsByTagName("Linear")[0]){var h=e.getElementsByTagName("MediaFile")[0];b.push({type:h.getAttribute("type"),bitrate:Number(h.getAttribute("bitrate")),
width:Number(h.getAttribute("width")),height:Number(h.getAttribute("height")),assetUrl:h.textContent,tracking:this._getTracking(e),clickUrl:this._getClickUrl(e)})}}if(0<b.length)return b};b.prototype._getVpaidCreative=function(){var a;if(a=this._node.getElementsByTagName(this.format)[0]){var b=a.getElementsByTagName("AdParameters")[0];if((a=a.getElementsByTagName("MediaFile")[0])&&b)return b=b.textContent,{mediaFile:{url:a.textContent,width:Number(a.getAttribute("width")),height:Number(a.getAttribute("height")),
type:a.getAttribute("type"),tracking:this._getTracking(a)},adParams:b}}};b.prototype._getTracking=function(a){var c,b;var f=[];if(b=a.getElementsByTagName("Tracking")){a=0;for(c=b.length;a<c;a++){var e=b[a];f.push({event:e.getAttribute("event"),url:e.textContent})}return f}};b.prototype._getClickUrl=function(a){if(a=a.getElementsByTagName("ClickThrough")[0])return a.textContent};b.prototype._getCompanion=function(){var c;if(c=/<CompanionAds>([^)]+)<\/CompanionAds>/.exec(this._config.data))if(c=c[0],
"String"===a["typeof"](c)&&0<c.length)return c};b.prototype._getType=function(){return this._node.querySelectorAll("[apiFramework=VPAID]")[0]?"VPAID":"VAST"};b.prototype._getImpressions=function(){var a;var b=[];var d=this._node.getElementsByTagName("Impression");var f=0;for(a=d.length;f<a;f++){var e=d[f];b.push({url:e.textContent})}return b};b.prototype._getCreativeNode=function(){var a;return(a=this._node.getElementsByTagName("Linear")[0])?a:this._node.getElementsByTagName("NonLinear")[0]};b.prototype._getSkipOffset=
function(a){var b;a={};if(b=this._node.getElementsByTagName(this.format)[0])if(b=b.getAttribute("skipoffset"),null!=b){if(-1<b.indexOf(":")){a.type="seconds";var c=b.split(":");b=Number(c[1]);c=Number(c[2]);a.value=60*b+c;return a}if(-1<b.indexOf("%"))return a.type="percent",a.value=.01*Number(b.replace("%","")),a}};b.prototype._getRetVal=function(){return{data:this.data,url:this.url,format:this.format,type:this.type,creatives:this.creatives,companion:this.companion,impressions:this.impressions,offset:this.offset,
skipOffset:this.skipOffset}};return b}();
core.event.EventDispatcher=function(){function b(a){this.listeners=null!=a?a:[];this.dispatchEvent=bind(this.dispatchEvent,this);this.removeEventListener=bind(this.removeEventListener,this);this.on=this.addEventListener=bind(this.addEventListener,this);this.off=this.removeEventListener;this.emit=this.dispatchEvent}b.prototype.addEventListener=function(a,b){return this.listeners.push({type:a,callback:b})};b.prototype.removeEventListener=function(a,b){var c,d,f;var e=[];for(c=d=f=this.listeners.length-
1;0>=f?0>d:0<d;c=0>=f?++d:--d){var h=this.listeners[c];h.type===a&&h.callback===b?e.push(this.listeners.splice(c,1)):e.push(void 0)}return e};b.prototype.dispatchEvent=function(a,b){var c;null==b&&(b=null);b={target:this,type:a,data:b};var d=this.listeners;var f=[];var e=0;for(c=d.length;e<c;e++){var h=d[e];h.type===a?f.push(h.callback(b)):f.push(void 0)}return f};return b}();core.event.Event=function(){function b(){}b.MODEL_CHANGED="modelChanged";b.READY="ready";b.RESIZE="resize";return b}();
core.model.Model=function(b){function a(){this._checkCookies=bind(this._checkCookies,this);this._checkQueries=bind(this._checkQueries,this);this.pullData=bind(this.pullData,this);this.getData=bind(this.getData,this);this.setData=bind(this.setData,this);a.__super__.constructor.call(this);this.pullData()}extend(a,b);var c=core.common.Utils;var g=core.event.Event;a.prototype.data={};a.prototype.setData=function(a,b){this.data[a]=b;return this.dispatchEvent(g.MODEL_CHANGED,{key:a,value:b})};a.prototype.getData=
function(a){return void 0===a?this.data:this.data[a]};a.prototype.pullData=function(){};a.prototype._checkQueries=function(){var a;var b=[];for(a in this.data){var e=c.getQuery(a);"true"===e&&(e=!0);"false"===e&&(e=!1);b.push(this.data[a]=null!=e?e:this.data[a])}return b};a.prototype._checkCookies=function(){var a;var b=[];for(a in this.data){var e=c.getCookie(a);"true"===e&&(e=!0);"false"===e&&(e=!1);b.push(this.data[a]=null!=e?e:this.data[a])}return b};return a}(core.event.EventDispatcher);
admanager.model.AdModels=function(b){function a(b){this.manager=b;this._emitError=bind(this._emitError,this);this._emitReady=bind(this._emitReady,this);this._parseString=bind(this._parseString,this);this._requestAdData=bind(this._requestAdData,this);this._parseArray=bind(this._parseArray,this);this.pullData=bind(this.pullData,this);this.ads=this.manager.config.ads;a.__super__.constructor.call(this)}extend(a,b);var c=core.common.Utils;var g=admanager.model.AdModel;var d=admanager.event.Event;a.prototype.data=
[];a.prototype.loaded=0;a.prototype.pullData=function(){switch(c["typeof"](this.ads)){case "Array":return this._parseArray();case "String":return this._parseString();default:return this._emitError()}};a.prototype._parseArray=function(){var a;if(0===this.ads.length)return this._emitReady();var b=this.ads;var c=[];var d=0;for(a=b.length;d<a;d++){var g=b[d];c.push(this._requestAdData(g))}return c};a.prototype._requestAdData=function(a){return c.request(a.url,function(b){return function(c){a.data=c.data;
(c=new g(a),c.creatives)&&b.data.push(c);if(++b.loaded===b.ads.length)return b._emitReady()}}(this))};a.prototype._parseString=function(){console.log("_parseString");return this._emitReady()};a.prototype._emitReady=function(){return setTimeout(function(a){return function(){return a.emit(d.DATA_LOAD_COMPLETE)}}(this),1)};a.prototype._emitError=function(a){null==a&&(a="Error parsing ad configuration");return this.emit(d.PLUGIN_ERROR,{error:a})};return a}(core.model.Model);
admanager.view.CountdownView=function(){function b(a){this.parent=a;this._css=bind(this._css,this);this.update=bind(this.update,this);this.node=document.createElement("div");this.node.style.cssText=this._css();this.node.innerHTML="Advertisement";this.parent.appendChild(this.node)}b.prototype.update=function(a,b){a=parseInt(b-a);return this.node.innerHTML="Remaining Time: "+a};b.prototype._css=function(){return"padding: 5px; font-size: 85%; color: white; background-color: black; opacity: 0.6; text-align: center; border-bottom: 1px solid rgb(104, 104, 104);"};
return b}();admanager.view.ClickView=function(){function b(a){this.parent=a;this._css=bind(this._css,this);this.node=document.createElement("node");this.node.style.cssText=this._css();this.parent.appendChild(this.node)}b.prototype._css=function(){return"width: 100%; height: 100%; cursor: pointer; position: absolute; top: 0; left: 0;"};return b}();
admanager.view.ResumeView=function(){function b(a){this.parent=a;this._graphicCss=bind(this._graphicCss,this);this._css=bind(this._css,this);this._getGraphic=bind(this._getGraphic,this);this._getNode=bind(this._getNode,this);this.hide=bind(this.hide,this);this.show=bind(this.show,this);this.width=100;this.node=this._getNode();this.graphic=this._getGraphic();this.node.appendChild(this.graphic);this.parent.appendChild(this.node)}b.prototype.show=function(){return this.node.style.display="block"};b.prototype.hide=
function(){return this.node.style.display="none"};b.prototype._getNode=function(){var a=document.createElement("node");a.style.cssText=this._css();return a};b.prototype._getGraphic=function(){var a=document.createElement("canvas");a.width=this.width;a.height=this.width;a.style.cssText=this._graphicCss();var b=a.getContext("2d");b.strokeStyle="white";b.fillStyle="white";b.beginPath();b.moveTo(0,0);b.lineTo(this.width,.5*this.width);b.lineTo(0,this.width);b.lineTo(0,0);b.fill();return a};b.prototype._css=
function(){return"width: 100%; height: 100%; cursor: pointer; position: absolute; top: 0; left: 0; background-color: black; opacity: 0.8; display: none;"};b.prototype._graphicCss=function(){return"position: absolute; left: 50%; top: 50%; margin-left: "+.5*-this.width+"px; margin-top: "+.5*-this.width+"px;"};return b}();
admanager.view.SkipView=function(){function b(a,b){this.parent=a;this.config=b;this._css=bind(this._css,this);this.update=bind(this.update,this);if(!this.config)return this;this.node=document.createElement("div");"seconds"===this.config.type&&(this.offset=this.config.value);this.node.style.cssText=this._css();this.node.innerHTML="Skip &rarr;";this.parent.appendChild(this.node)}b.prototype.offset=null;b.prototype.width=100;b.prototype.height=25;b.prototype.update=function(a,b){if(this.config&&"block"!==
this.node.style.display&&(null==this.offset&&(this.offset=b*this.config.value),a>=this.offset))return this.node.style.display="block"};b.prototype._css=function(){return"font-size: 125%; color: white; opacity: 0.6; cursor: pointer; position: absolute; background-color: black; right: 0; padding: 8px 20px 8px 20px; margin-top: 5px; border: 1px solid rgb(104, 104, 104); border-right: 0; display: none;"};return b}();
admanager.view.AdView=function(b){function a(b,c){this.manager=b;this.config=c;this._getFsState=bind(this._getFsState,this);this._sendTracking=bind(this._sendTracking,this);this._sendImpressions=bind(this._sendImpressions,this);this._stopTimer=bind(this._stopTimer,this);this._sendAdRmainingTime=bind(this._sendAdRmainingTime,this);this._startTimer=bind(this._startTimer,this);this.stop=bind(this.stop,this);this.start=bind(this.start,this);this.resize=bind(this.resize,this);a.__super__.constructor.call(this)}
extend(a,b);var c=core.common.Utils;var g=admanager.event.Event;a.prototype.error=!0;a.prototype.timer=null;a.prototype.muted=!1;a.prototype.prevVolume=1;a.prototype.contentTime=0;a.prototype.contentSrc="";a.prototype.started=!1;a.prototype.stopped=!1;a.prototype.resize=function(a,b){};a.prototype.start=function(){this.started=!0;this.contentSrc=this.video.currentSrc;this.contentTime=this.video.currentTime;this.prevVolume=this.video.volume;this.muted=this.video.muted;if(this.ad){this.prevVolume=this.ad.getAdVolume().toFixed(2);
this._sendTracking("getVolume",this.prevVolume);var a=this.ad.getAdDuration().toFixed(2);this._sendTracking("adDuration",a);this._sendTracking("adRemainingTime",this.ad.getAdRemainingTime());this._remaininTimeInterval=setInterval(this._sendAdRmainingTime,1E3)}this._startTimer();return this.manager.emit(g.AD_STARTED,{ad:this.config})};a.prototype.stop=function(){clearInterval(this._remaininTimeInterval);this.stopped=!0;this._stopTimer();this.manager.config.adContainer.innerHTML="";return this.manager.emit(g.AD_STOPPED)};
a.prototype._startTimer=function(){if(null==this.timer)return this.timer=setTimeout(this.stop,15E3)};a.prototype._sendAdRmainingTime=function(){return this._sendTracking("adRemainingTime",this.ad.getAdRemainingTime())};a.prototype._stopTimer=function(){clearTimeout(this.timer);if(this.error)return this._sendTracking("error")};a.prototype._sendImpressions=function(){var a;if(this.config.impressions){var b=this.config.impressions;var e=[];var h=0;for(a=b.length;h<a;h++){var m=b[h];c.request(m.url);
e.push(this.manager.emit(g.AD_REPORTED,{type:"impression"}))}return e}};a.prototype._sendTracking=function(a,b){var d;if(this.creative&&this.creative.tracking){var f=this.creative.tracking;var m=0;for(d=f.length;m<d;m++){var k=f[m];if(k.event===a)var l=k.url}}null!=l&&c.request(l);return this.manager.emit(g.AD_REPORTED,{type:a,value:b})};a.prototype._getFsState=function(){var a;null!=document.fullscreen?a=document.fullscreen:null!=document.mozFullScreen?a=document.mozFullScreen:null!=document.webkitIsFullScreen?
a=document.webkitIsFullScreen:null!=document.msFullscreenElement&&(a=null!==document.msFullscreenElement);null==a&&(a=!1);return a};return a}(core.event.EventDispatcher);
admanager.view.VastView=function(b){function a(b,c){this.manager=b;this.config=c;this._onCreativeError=bind(this._onCreativeError,this);this._onCreativeSuccess=bind(this._onCreativeSuccess,this);this._getCreative=bind(this._getCreative,this);this._onClick=bind(this._onClick,this);this._onSkip=bind(this._onSkip,this);this._onResume=bind(this._onResume,this);this._onFullScreenChange=bind(this._onFullScreenChange,this);this._onError=bind(this._onError,this);this._onEnded=bind(this._onEnded,this);this._onVolumeChange=
bind(this._onVolumeChange,this);this._checkQuartile=bind(this._checkQuartile,this);this._onSeeked=bind(this._onSeeked,this);this._onSeeking=bind(this._onSeeking,this);this._checkForReset=bind(this._checkForReset,this);this._onTimeUpdate=bind(this._onTimeUpdate,this);this._onPause=bind(this._onPause,this);this._onPlay=bind(this._onPlay,this);this._onContentMeta=bind(this._onContentMeta,this);this._display=bind(this._display,this);this.stop=bind(this.stop,this);this.start=bind(this.start,this);a.__super__.constructor.call(this,
this.manager,this.config);this.video=this.manager.config.videoTag}extend(a,b);var c=core.common.Utils;var g=admanager.event.Event;var d=admanager.view.SkipView;var f=admanager.view.ResumeView;var e=admanager.view.ClickView;var h=admanager.view.CountdownView;a.prototype.hasPlayed=!1;a.prototype.quartiles={};a.prototype.viewed=0;a.prototype.skipOffset=null;a.prototype.start=function(){if(!this.started)return a.__super__.start.call(this),this.click=new e(this.manager.config.adContainer),this.resume=
new f(this.manager.config.adContainer),this.countdown=new h(this.manager.config.adContainer),this.skip=new d(this.manager.config.adContainer,this.config.skipOffset),this.skip.node&&(this.skip.node.onclick=this._onSkip),this.resume.node&&(this.resume.node.onclick=this._onResume),this.click.node&&(this.click.node.onclick=this._onClick),this._getCreative()};a.prototype.stop=function(){if(!this.stopped)return a.__super__.stop.call(this),c.on(this.video,"loadedmetadata",this._onContentMeta),c.off(this.video,
"play",this._onPlay),c.off(this.video,"pause",this._onPause),c.off(this.video,"timeupdate",this._onTimeUpdate),c.off(this.video,"seeking",this._onSeeking),c.off(this.video,"seeked",this._onSeeked),c.off(this.video,"volumechange",this._onVolumeChange),c.off(this.video,"ended",this._onEnded),c.off(this.video,"error",this._onError),c.off(document,"fullscreenchange",this._onFullScreenChange),c.off(document,"mozfullscreenchange",this._onFullScreenChange),c.off(document,"webkitfullscreenchange",this._onFullScreenChange),
c.off(document,"msfullscreenchange",this._onFullScreenChange),this.video.src=this.contentSrc,this.video.load()};a.prototype._display=function(){c.on(this.video,"play",this._onPlay);c.on(this.video,"pause",this._onPause);c.on(this.video,"timeupdate",this._onTimeUpdate);c.on(this.video,"seeking",this._onSeeking);c.on(this.video,"seeked",this._onSeeked);c.on(this.video,"volumechange",this._onVolumeChange);c.on(this.video,"ended",this._onEnded);c.on(document,"fullscreenchange",this._onFullScreenChange);
c.on(document,"mozfullscreenchange",this._onFullScreenChange);c.on(document,"webkitfullscreenchange",this._onFullScreenChange);c.on(document,"msfullscreenchange",this._onFullScreenChange);this.error=!1;this.quartiles.first={reported:!1,time:.25*this.video.duration,type:"firstQuartile"};this.quartiles.second={reported:!1,time:.5*this.video.duration,type:"midpoint"};this.quartiles.third={reported:!1,time:.75*this.video.duration,type:"thirdQuartile"};this._sendTracking("creativeView");this._sendImpressions();
this._stopTimer();return this.video.play()};a.prototype._onContentMeta=function(){c.off(this.video,"loadedmetadata",this._onContentMeta);0<this.contentTime&&(this.video.currentTime=this.contentTime);this.contentTime<this.video.duration&&this.video.play();return this.emit(g.AD_COMPLETE)};a.prototype._onPlay=function(){var a=this.hasPlayed?"resume":"start";this.hasPlayed=!0;return this._sendTracking(a)};a.prototype._onPause=function(){if(!this.video.ended)return this.manager.emit(g.AD_REPORTED,{type:"pause"})};
a.prototype._onTimeUpdate=function(){if(this.seeking)c.off(this.video,"play",this._onPlay),c.off(this.video,"ended",this._onEnded),c.off(this.video,"timeupdate",this._onTimeUpdate),c.on(this.video,"timeupdate",this._checkForReset);else if(this.manager.emit(g.AD_REPORTED,{type:"progress"}),this.countdown.update(this.video.currentTime,this.video.duration),this.skip.update(this.video.currentTime,this.video.duration),this._checkQuartile(this.quartiles.first),this._checkQuartile(this.quartiles.second),
this._checkQuartile(this.quartiles.third),this.video.currentTime>this.viewed)return this.viewed=this.video.currentTime};a.prototype._checkForReset=function(){if(!this.seeking)if(this.video.currentTime>this.viewed&&this.viewed<this.skipOffset)this.video.currentTime=Math.floor(this.viewed)-.2,this.video.play();else return c.on(this.video,"play",this._onPlay),c.on(this.video,"ended",this._onEnded),c.on(this.video,"timeupdate",this._onTimeUpdate),c.off(this.video,"timeupdate",this._checkForReset)};a.prototype._onSeeking=
function(){return this.seeking=!0};a.prototype._onSeeked=function(){return this.seeking=!1};a.prototype._checkQuartile=function(a){if(!(a.reported||this.video.currentTime<a.time))return this._sendTracking(a.type),a.reported=!0};a.prototype._onVolumeChange=function(){this.video.muted||0===this.video.volume?this._sendTracking("mute"):(!this.video.muted&&this.muted||0<this.video.volume&&0===this.prevVolume)&&this._sendTracking("unmute");this.prevVolume=this.video.volume;return this.muted=this.video.muted};
a.prototype._onEnded=function(){this._sendTracking("complete");return this.stop()};a.prototype._onError=function(){this._sendTracking("error");return this.stop()};a.prototype._onFullScreenChange=function(){var a=this._getFsState();return this._sendTracking(a?"fullscreen":"exitFullscreen")};a.prototype._onResume=function(){this.resume.hide();return this.video.play()};a.prototype._onSkip=function(){this._sendTracking("skip");return this.stop()};a.prototype._onClick=function(){if(null!=this.creative.clickUrl)return this.resume.show(),
this.video.pause(),this._sendTracking("clickTracking"),window.open(this.creative.clickUrl,"_blank")};a.prototype._getCreative=function(){var a;var b=this.config.creatives;var d=0;for(a=b.length;d<a;d++){var e=b[d];if(!e.checked&&(e.checked=!0,""!==this.video.canPlayType(e.type))){c.on(this.video,"loadedmetadata",this._onCreativeSuccess);c.on(this.video,"error",this._onCreativeError);this.creative=e;this.video.src=e.assetUrl;this.video.load();return}}return this.stop()};a.prototype._onCreativeSuccess=
function(){this.skipOffset="undefined"!==typeof this.config.skipOffset?this.config.skipOffset.value:this.video.duration;c.off(this.video,"loadedmetadata",this._onCreativeSuccess);c.off(this.video,"error",this._onCreativeError);return this._display()};a.prototype._onCreativeError=function(){c.off(this.video,"loadedmetadata",this._onCreativeSuccess);c.off(this.video,"error",this._onCreativeError);this.creative=null;return this._getCreative()};return a}(admanager.view.AdView);
admanager.view.VpaidView=function(b){function a(b,c){this.manager=b;this.config=c;this._getVpaidEvents=bind(this._getVpaidEvents,this);this._onAdLog=bind(this._onAdLog,this);this._onAdExpandedChange=bind(this._onAdExpandedChange,this);this._onAdDurationChange=bind(this._onAdDurationChange,this);this._onAdLinearChange=bind(this._onAdLinearChange,this);this._onAdSizeChange=bind(this._onAdSizeChange,this);this._onAdStoppableStateChange=bind(this._onAdStoppableStateChange,this);this._onAdSkippableStateChange=
bind(this._onAdSkippableStateChange,this);this._onAdError=bind(this._onAdError,this);this._onAdPlaying=bind(this._onAdPlaying,this);this._onAdPaused=bind(this._onAdPaused,this);this._onAdUserClose=bind(this._onAdUserClose,this);this._onAdUserMinimize=bind(this._onAdUserMinimize,this);this._onAdUserAcceptInvitation=bind(this._onAdUserAcceptInvitation,this);this._onAdInteraction=bind(this._onAdInteraction,this);this._onAdClickThru=bind(this._onAdClickThru,this);this._onAdVideoComplete=bind(this._onAdVideoComplete,
this);this._onAdVideoThirdQuartile=bind(this._onAdVideoThirdQuartile,this);this._onAdVideoMidpoint=bind(this._onAdVideoMidpoint,this);this._onAdVideoFirstQuartile=bind(this._onAdVideoFirstQuartile,this);this._onAdVideoStart=bind(this._onAdVideoStart,this);this._onAdImpression=bind(this._onAdImpression,this);this._onAdVolumeChange=bind(this._onAdVolumeChange,this);this._onAdSkipped=bind(this._onAdSkipped,this);this._onAdStopped=bind(this._onAdStopped,this);this._onAdStarted=bind(this._onAdStarted,
this);this._onAdLoaded=bind(this._onAdLoaded,this);this._removeListeners=bind(this._removeListeners,this);this._addListeners=bind(this._addListeners,this);this._getScript=bind(this._getScript,this);this._getNode=bind(this._getNode,this);this._getFrame=bind(this._getFrame,this);this._initAd=bind(this._initAd,this);this._onScriptLoaded=bind(this._onScriptLoaded,this);this._onFrameLoaded=bind(this._onFrameLoaded,this);this._loadScript=bind(this._loadScript,this);this._hide=bind(this._hide,this);this._show=
bind(this._show,this);this._onContentMeta=bind(this._onContentMeta,this);this._resume=bind(this._resume,this);this._display=bind(this._display,this);this.resize=bind(this.resize,this);this.stop=bind(this.stop,this);this.start=bind(this.start,this);a.__super__.constructor.call(this,this.manager,this.config);this.sendAdSize=!this.manager.config.data.noSize;this.video=this.manager.config.videoTag;this.container=this.manager.config.adContainer;this.creative=this.config.creatives;this.node=this._getNode();
this.frame=this._getFrame();this.script=this._getScript();this._loadScript()}extend(a,b);var c=core.common.Utils;var g=admanager.event.Event;a.prototype.loaded=!1;a.prototype.ad=null;a.prototype.start=function(){if(!this.started&&(a.__super__.start.call(this),this.loaded))return this._display()};a.prototype.stop=function(){if(!this.stopped)return a.__super__.stop.call(this),this._removeListeners(),this._hide(),this._resume()};a.prototype.resize=function(a,b){a=this.sendAdSize?a:null;b=this.sendAdSize?
b:null;return this.ad.resizeAd(a,b)};a.prototype._display=function(){"Linear"===this.config.format&&this.video.pause();this._show();this._addListeners();this._initAd();return this._sendTracking("adIcon",~~this.ad.getAdIcons())};a.prototype._resume=function(){c.on(this.video,"loadedmetadata",this._onContentMeta);this.video.src=this.contentSrc;return this.video.load()};a.prototype._onContentMeta=function(){c.off(this.video,"loadedmetadata",this._onContentMeta);0<this.contentTime&&(this.video.currentTime=
this.contentTime);this.contentTime<this.video.duration&&this.video.play();return this.emit(g.AD_COMPLETE)};a.prototype._show=function(){return this.container.appendChild(this.node)};a.prototype._hide=function(){this.node.parentNode&&this.node.parentNode.removeChild(this.node);if(this.frame.parentNode)return this.frame.parentNode.removeChild(this.frame)};a.prototype._loadScript=function(){this.frame.onload=this._onFrameLoaded;return document.body.appendChild(this.frame)};a.prototype._onFrameLoaded=
function(){this.script.onload=this._onScriptLoaded;return this.frame.contentDocument.body.appendChild(this.script)};a.prototype._onScriptLoaded=function(){if(this.frame.contentWindow.getVPAIDAd){if(this.ad=this.frame.contentWindow.getVPAIDAd(),this.loaded=!0,this.started)return this._display()}else this.stop()};a.prototype._initAd=function(){var a=this.sendAdSize?this.video.width:null;var b=this.sendAdSize?this.video.height:null;var c=this._getFsState()?"fullscreen":"normal";var h={AdParameters:this.config.creatives.adParams};
var g={slot:this.node,videoSlot:this.video,videoSlotCanAutoPlay:!0};this.ad.handshakeVersion("2.0");return this.ad.initAd(a,b,c,300,h,g)};a.prototype._getFrame=function(){var a=document.createElement("iframe");a.width=1;a.height=1;a.style.opacity=0;a.id="SZMKPlayerIframeContainer";a.src="about:blank";a.setAttribute("frameborder","0");return a};a.prototype._getNode=function(){return document.createElement("div")};a.prototype._getScript=function(){var a=document.createElement("script");a.src=this.config.creatives.mediaFile.url;
return a};a.prototype._addListeners=function(){var a;var b=this._getVpaidEvents();var c=[];for(a in b){var g=b[a];c.push(this.ad.subscribe(g,a,this))}return c};a.prototype._removeListeners=function(){var a;var b=this._getVpaidEvents();var c=[];for(a in b){var g=b[a];c.push(this.ad.unsubscribe(g,a,this))}return c};a.prototype._onAdLoaded=function(){this.error=!1;this._stopTimer();return this.ad.startAd()};a.prototype._onAdStarted=function(){return this._sendTracking("creativeView")};a.prototype._onAdStopped=
function(){return this.stop()};a.prototype._onAdSkipped=function(){this._sendTracking("skip");return this.stop()};a.prototype._onAdVolumeChange=function(a){a=this.ad.getAdVolume();a!==this.prevVolume&&this._sendTracking("getVolume",a.toFixed(2));0===a?this._sendTracking("mute"):this._sendTracking("unmute");return this.prevVolume=a};a.prototype._onAdImpression=function(){return this._sendImpressions()};a.prototype._onAdVideoStart=function(){return this._sendTracking("start")};a.prototype._onAdVideoFirstQuartile=
function(){return this._sendTracking("firstQuartile")};a.prototype._onAdVideoMidpoint=function(){return this._sendTracking("midpoint")};a.prototype._onAdVideoThirdQuartile=function(){return this._sendTracking("thirdQuartile")};a.prototype._onAdVideoComplete=function(){return this._sendTracking("complete")};a.prototype._onAdClickThru=function(){return this._sendTracking("clickTracking")};a.prototype._onAdInteraction=function(){return this._sendTracking("interaction")};a.prototype._onAdUserAcceptInvitation=
function(){return this._sendTracking("acceptInvitation")};a.prototype._onAdUserMinimize=function(){};a.prototype._onAdUserClose=function(){this._sendTracking("close");return this.stop()};a.prototype._onAdPaused=function(){return this._sendTracking("pause")};a.prototype._onAdPlaying=function(){return this._sendTracking("resume")};a.prototype._onAdError=function(){this._sendTracking("error");return this.stop()};a.prototype._onAdSkippableStateChange=function(){return this._sendTracking("skipStateChange")};
a.prototype._onAdStoppableStateChange=function(){return this._sendTracking("stopStateChange")};a.prototype._onAdSizeChange=function(){this._sendTracking("adSizeChange");this._sendTracking("adWidth",this.ad.getAdWidth());return this._sendTracking("adHeight",this.ad.getAdHeight())};a.prototype._onAdLinearChange=function(){};a.prototype._onAdDurationChange=function(){this._sendTracking("adDurationChange");var a=this.ad.getAdDuration().toFixed(2);this._sendTracking("adDuration",a);a=this.ad.getAdRemainingTime().toFixed(2);
return this._sendTracking("adRemainingTime",a)};a.prototype._onAdExpandedChange=function(){};a.prototype._onAdLog=function(){};a.prototype._getVpaidEvents=function(){return{AdLoaded:this._onAdLoaded,AdStarted:this._onAdStarted,AdStopped:this._onAdStopped,AdSkipped:this._onAdSkipped,AdSkippableStateChange:this._onAdSkippableStateChange,AdStoppableStateChange:this._onAdStoppableStateChange,AdSizeChange:this._onAdSizeChange,AdLinearChange:this._onAdLinearChange,AdDurationChange:this._onAdDurationChange,
AdExpandedChange:this._onAdExpandedChange,AdVolumeChange:this._onAdVolumeChange,AdImpression:this._onAdImpression,AdVideoStart:this._onAdVideoStart,AdVideoFirstQuartile:this._onAdVideoFirstQuartile,AdVideoMidpoint:this._onAdVideoMidpoint,AdVideoThirdQuartile:this._onAdVideoThirdQuartile,AdVideoComplete:this._onAdVideoComplete,AdClickThru:this._onAdClickThru,AdInteraction:this._onAdInteraction,AdUserAcceptInvitation:this._onAdUserAcceptInvitation,AdUserMinimize:this._onAdUserMinimize,AdUserClose:this._onAdUserClose,
AdPaused:this._onAdPaused,AdPlaying:this._onAdPlaying,AdLog:this._onAdLog,AdError:this._onAdError}};return a}(admanager.view.AdView);
admanager.view.AdViews=function(b){function a(a){this.manager=a;this._setupPostrolls=bind(this._setupPostrolls,this);this._onAdComplete=bind(this._onAdComplete,this);this._checkAdList=bind(this._checkAdList,this);this._onFirstPlay=bind(this._onFirstPlay,this);this.resume=bind(this.resume,this);this.resize=bind(this.resize,this);this.populate=bind(this.populate,this);this.video=this.manager.config.videoTag}extend(a,b);var c=core.common.Utils;var g=admanager.event.Event;var d=admanager.view.VpaidView;
var f=admanager.view.VastView;a.prototype.ads=[];a.prototype.ad=null;a.prototype.shown=0;a.prototype.populate=function(a){var b;var e=this.data=a;a=0;for(b=e.length;a<b;a++){var k=e[a];if(k.creatives){var l="VAST"===k.type?f:d;l=new l(this.manager,k);this.ads.push(l)}else this.manager.emit(g.AD_REPORTED,{type:"error"})}return(a=navigator.userAgent.match(/(iPhone|iPad|Ipad).*([1-3]\d).*(CriOS)\/(\d*)/))&&3<a.length&&9<a[2]&&53<a[4]?c.on(this.video,"playing",this._onFirstPlay):c.on(this.video,"play",
this._onFirstPlay)};a.prototype.resize=function(a,b){if(this.ad)return this.ad.resize(a,b)};a.prototype.resume=function(){if(this.ad)return this.ad.stop()};a.prototype._onFirstPlay=function(){var a;(a=navigator.userAgent.match(/(iPhone|iPad|Ipad).*([1-3]\d).*(CriOS)\/(\d*)/))&&3<a.length&&9<a[2]&&53<a[4]?c.off(this.video,"playing",this._onFirstPlay):c.off(this.video,"play",this._onFirstPlay);c.on(this.video,"timeupdate",this._checkAdList);this._setupPostrolls();return this._checkAdList()};a.prototype._checkAdList=
function(){var a;var b=this.ads;var d=0;for(a=b.length;d<a;d++){var f=b[d];if(!(f.started||this.video.currentTime<f.config.offset)){c.off(this.video,"timeupdate",this._checkAdList);c.off(this.video,"ended",this._onEnded);f.on(g.AD_COMPLETE,this._onAdComplete);f.start();this.ad=f;this.shown++;break}}return[]};a.prototype._onAdComplete=function(){this.ad=null;this._checkAdList();if(!this.ad&&this.shown!==this.ads.length)return c.on(this.video,"timeupdate",this._checkAdList)};a.prototype._setupPostrolls=
function(){var a;var b=this.ads;var c=[];var d=0;for(a=b.length;d<a;d++){var f=b[d];"end"===f.config.offset?c.push(f.config.offset=this.video.duration):c.push(void 0)}return c};return a}(core.event.EventDispatcher);
admanager.AdManager=function(b){function a(b){this.config=b;this.resize=bind(this.resize,this);this.stop=bind(this.stop,this);a.__super__.constructor.call(this);this.models=new g(this);this.views=new c(this);this.controller=new d(this)}extend(a,b);var c=admanager.view.AdViews;var g=admanager.model.AdModels;var d=admanager.controller.Controller;a.prototype.stop=function(){return this.views.resumeContent()};a.prototype.resize=function(a,b){return this.views.resize(a,b)};return a}(core.event.EventDispatcher);
window.SizmekAdManager=admanager.AdManager;
